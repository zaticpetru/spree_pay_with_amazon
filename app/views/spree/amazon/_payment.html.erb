<%# %>
<%# Amazon Payments - Login and Pay for Spree Commerce %>
<%# %>
<%# @category    Amazon %>
<%# @package     Amazon_Payments %>
<%# @copyright   Copyright (c) 2014 Amazon.com %>
<%# @license     http://opensource.org/licenses/Apache-2.0  Apache License, Version 2.0 %>
<%# %>
var amazon_payment_post = false;
new OffAmazonPayments.Widgets.Wallet({
  sellerId: '<%= @amazon_gateway.preferred_merchant_id %>',
  onPaymentSelect: function(orderReference) {
    window.alert("offAmazonPayments");
    $('#amzWidgetSubmit').addClass("disabled");
    $('#amzWidgetSubmit').addClass("hidden");
    $('#amz_overlay').removeClass("hidden");
    jQuery.post(
      '/amazon_order/payment',
      {"order_reference": order_reference},
      function() {
        amazon_payment_post = false;
        amazonLoadingClick();
      }
    );
  },
  design: {
    designMode: 'responsive'
  },
  onError: function(error) {
    window.alert("offAmazonPayments_onError");
    $('#amz_overlay').addClass("hidden");
  }
}).bind("walletWidgetDiv");
